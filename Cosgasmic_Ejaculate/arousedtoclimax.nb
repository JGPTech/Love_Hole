(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     52211,       1289]
NotebookOptionsPosition[     51846,       1275]
NotebookOutlinePosition[     52250,       1291]
CellTagsIndexPosition[     52207,       1288]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"::", "Package", "::"}], "*)"}], 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     RowBox[{
      RowBox[{
      "Enhanced", " ", "Cosmic", " ", "Genesis", " ", "Simulator", " ", "v4", 
       ".0"}], "-", 
      RowBox[{"Clean", " ", "Interactive", " ", "Version"}]}], "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", 
     RowBox[{"Part", " ", "3"}]}], ":", 
    RowBox[{
     RowBox[{
     "Dark", " ", "Matter", " ", "as", " ", "Cosgasmic", " ", "Ejaculate", " ",
       "Streamlined", " ", "execution", " ", "with", " ", "data", " ", 
      "export", " ", "and", " ", "interactive"}], "-", 
     RowBox[{"only", " ", "output"}]}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
    "==="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"SETUP", " ", "AND", " ", "DATA", " ", "IMPORT"}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
    "==="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "working", " ", "directory"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
    "SetDirectory", 
     "[", "\"\<C:\\\\Cosgasmic_Ejaculate\\\\darkmatter_cache\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Configuration", "*)"}], "\n", 
   RowBox[{
    RowBox[{"dataFile", "=", "\"\<final_enhanced_mathematica_data.csv\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"outputDir", "=", "\"\<simulation_results\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", "outputDir", "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", "outputDir", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simulation", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"kSteepness", "=", "0.8"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"x0Threshold", "=", "5.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tMax", "=", "13.8"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Import", " ", "and", " ", "process", " ", "data", " ", "silently"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"rawData", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Import", "[", 
       RowBox[{"dataFile", ",", "\"\<Dataset\>\""}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Safe", " ", "data", " ", "extraction"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SafeExtract", "[", 
      RowBox[{"dataset_", ",", "column_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"values", ",", "cleanValues"}], "}"}], ",", 
       RowBox[{
        RowBox[{"values", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"dataset", "[", 
           RowBox[{"All", ",", "column"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cleanValues", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"values", ",", 
           RowBox[{"_Missing", "|", "_String"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cleanValues", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"cleanValues", ",", "NumericQ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "cleanValues", "]"}], "==", "0"}], ",", 
          RowBox[{"{", "1.0", "}"}], ",", "cleanValues"}], "]"}]}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Extract", " ", "data"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"arousalPotentials", "=", 
     RowBox[{"SafeExtract", "[", 
      RowBox[{"rawData", ",", "\"\<A_potential\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"enhancedArousalPotentials", "=", 
     RowBox[{"SafeExtract", "[", 
      RowBox[{"rawData", ",", "\"\<enhanced_A_potential\>\""}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"geneticPhenotypesRaw", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"rawData", "[", 
       RowBox[{"All", ",", "\"\<genetic_phenotype\>\""}], "]"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"geneticPhenotypes", "=", 
     RowBox[{"Replace", "[", 
      RowBox[{"geneticPhenotypesRaw", ",", 
       RowBox[{"_Missing", "->", "\"\<field_halo\>\""}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Get", " ", "consistent", " ", "array", " ", "length"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"numHalos", "=", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"Length", "[", "arousalPotentials", "]"}], ",", 
       RowBox[{"Length", "[", "enhancedArousalPotentials", "]"}], ",", 
       RowBox[{"Length", "[", "geneticPhenotypes", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"arousalPotentials", "=", 
     RowBox[{"Take", "[", 
      RowBox[{"arousalPotentials", ",", "numHalos"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"enhancedArousalPotentials", "=", 
     RowBox[{"Take", "[", 
      RowBox[{"enhancedArousalPotentials", ",", "numHalos"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"geneticPhenotypes", "=", 
     RowBox[{"Take", "[", 
      RowBox[{"geneticPhenotypes", ",", "numHalos"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     "==="}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"SIMULATION", " ", "EXECUTION"}], "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     "==="}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Genetic", " ", "modulation", " ", "factors"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"geneticModFactors", "=", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<giant_cluster_core\>\"", "->", "1.5"}], ",", 
       RowBox[{"\"\<spinning_colossus\>\"", "->", "1.3"}], ",", 
       RowBox[{"\"\<compact_dynamo\>\"", "->", "1.4"}], ",", 
       RowBox[{"\"\<turbulent_giant\>\"", "->", "1.2"}], ",", 
       RowBox[{"\"\<field_halo\>\"", "->", "1.0"}], ",", 
       RowBox[{"\"\<compact_dwarf\>\"", "->", "0.9"}], ",", 
       RowBox[{"\"\<diffuse_dwarf\>\"", "->", "0.8"}]}], "]"}]}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"haloMods", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{"geneticModFactors", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"geneticPhenotypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1.0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Enhanced", " ", "sigmoid", " ", "function"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EnhancedSigmoid", "[", 
      RowBox[{"arousal_", ",", "time_", ",", "geneticMod_"}], "]"}], ":=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "kSteepness"}], "*", "geneticMod", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"arousal", "*", "time"}], "-", "x0Threshold"}], ")"}]}], 
         "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Create", " ", "and", " ", "solve", " ", "differential", " ", 
     "equations"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"m", "[", "i", "]"}], "'"}], "[", "t", "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"m", "[", "i", "]"}], "[", "t", "]"}]}], ")"}], "*", 
         RowBox[{"EnhancedSigmoid", "[", 
          RowBox[{
           RowBox[{"enhancedArousalPotentials", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "t", ",", 
           RowBox[{"haloMods", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialConditions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "i", "]"}], "[", "0", "]"}], "==", "0.01"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fullSystem", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"equations", ",", "initialConditions"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "system"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"solution", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{"NDSolve", "[", 
       RowBox[{"fullSystem", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"m", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tMax"}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<LSODA\>\""}], ",", 
        RowBox[{"MaxSteps", "->", "5000"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     "==="}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DATA", " ", "ANALYSIS", " ", "AND", " ", "EXPORT"}], "*)"}], 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     "==="}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Calculate", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totalMass", "[", "t_", "]"}], ":=", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"m", "[", "i", "]"}], "[", "t", "]"}], "/.", " ", 
         RowBox[{"solution", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"finalMaturations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "i", "]"}], "[", "tMax", "]"}], "/.", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"phenotypeCounts", "=", 
     RowBox[{"Counts", "[", "geneticPhenotypes", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Phenotype", " ", "analysis"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"uniquePhenotypes", "=", 
     RowBox[{"Keys", "[", "phenotypeCounts", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"phenotypeMaturation", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"phenotype", ",", 
         RowBox[{"Mean", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"geneticPhenotypes", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "==", "phenotype"}], ",", 
              RowBox[{"finalMaturations", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Nothing"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phenotype", ",", "uniquePhenotypes"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Statistics", "*)"}], "\n", 
   RowBox[{
    RowBox[{"stats", "=", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<numHalos\>\"", "->", "numHalos"}], ",", 
       RowBox[{"\"\<meanBasicArousal\>\"", "->", 
        RowBox[{"Mean", "[", "arousalPotentials", "]"}]}], ",", 
       RowBox[{"\"\<meanEnhancedArousal\>\"", "->", 
        RowBox[{"Mean", "[", "enhancedArousalPotentials", "]"}]}], ",", 
       RowBox[{"\"\<enhancementFactor\>\"", "->", 
        RowBox[{
         RowBox[{"Mean", "[", "enhancedArousalPotentials", "]"}], "/", 
         RowBox[{"Mean", "[", "arousalPotentials", "]"}]}]}], ",", 
       RowBox[{"\"\<finalMean\>\"", "->", 
        RowBox[{"Mean", "[", "finalMaturations", "]"}]}], ",", 
       RowBox[{"\"\<finalMin\>\"", "->", 
        RowBox[{"Min", "[", "finalMaturations", "]"}]}], ",", 
       RowBox[{"\"\<finalMax\>\"", "->", 
        RowBox[{"Max", "[", "finalMaturations", "]"}]}], ",", 
       RowBox[{"\"\<finalStd\>\"", "->", 
        RowBox[{"StandardDeviation", "[", "finalMaturations", "]"}]}], ",", 
       RowBox[{"\"\<totalFinalMass\>\"", "->", 
        RowBox[{"totalMass", "[", "tMax", "]"}]}], ",", 
       RowBox[{"\"\<phenotypeCounts\>\"", "->", "phenotypeCounts"}], ",", 
       RowBox[{"\"\<phenotypeMaturation\>\"", "->", "phenotypeMaturation"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", " ", "all", " ", "data"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<simulation_parameters.json\>\""}], 
        "}"}], "]"}], ",", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<kSteepness\>\"", "->", "kSteepness"}], ",", 
        RowBox[{"\"\<x0Threshold\>\"", "->", "x0Threshold"}], ",", 
        RowBox[{"\"\<tMax\>\"", "->", "tMax"}]}], "]"}]}], "]"}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<simulation_statistics.json\>\""}], 
        "}"}], "]"}], ",", "stats"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<final_maturations.csv\>\""}], "}"}], 
       "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"geneticPhenotypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"arousalPotentials", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"enhancedArousalPotentials", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"haloMods", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"finalMaturations", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "numHalos"}], "}"}]}], "]"}], ",", 
      RowBox[{"\"\<Headers\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<HaloID\>\"", ",", "\"\<Phenotype\>\"", 
         ",", "\"\<BasicArousal\>\"", ",", "\"\<EnhancedArousal\>\"", 
         ",", "\"\<GeneticMod\>\"", ",", "\"\<FinalMaturation\>\""}], 
        "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", " ", "time", " ", "series", " ", "data", " ", 
     RowBox[{"(", "sampled", ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"timePoints", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "tMax", ",", 
       RowBox[{"tMax", "/", "100"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"timeSeriesData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"totalMass", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "timePoints"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<mass_evolution_timeseries.csv\>\""}], 
        "}"}], "]"}], ",", "timeSeriesData", ",", 
      RowBox[{"\"\<Headers\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Time_Gyr\>\"", ",", "\"\<TotalMass\>\""}], "}"}]}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", " ", "individual", " ", "halo", " ", "evolution", " ", 
     RowBox[{"(", 
      RowBox[{
      "for", " ", "top", " ", "10", " ", "by", " ", "final", " ", 
       "maturation"}], ")"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"topHalos", "=", 
     RowBox[{"TakeLargestBy", "[", 
      RowBox[{
       RowBox[{"Range", "[", "numHalos", "]"}], ",", 
       RowBox[{
        RowBox[{"finalMaturations", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "10"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"topHaloEvolution", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"haloID", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"m", "[", "haloID", "]"}], "[", "t", "]"}], "/.", " ", 
              RowBox[{"solution", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "timePoints"}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"haloID", ",", "topHalos"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<top_halo_evolution.json\>\""}], "}"}], 
       "]"}], ",", "topHaloEvolution"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     "==="}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "INTERACTIVE", " ", "VISUALIZATIONS", " ", "AND", " ", "FIGURE", " ", 
     "EXPORT"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     "==="}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<\|01f30c COSMIC GENESIS SIMULATOR v4.0 \|01f30c\>\"", 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Simulation complete. All data exported to: \>\"", ",", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directory", "[", "]"}], ",", "outputDir"}], "}"}], "]"}]}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Generating publication-quality figures...\\n\>\"", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Figure", " ", "1"}], ":", 
     RowBox[{
     "Maturation", " ", "Evolution", " ", "Curves", " ", "by", " ", 
      "Phenotype"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"uniquePhenotypes", "=", 
     RowBox[{"DeleteDuplicates", "[", "geneticPhenotypes", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"representativeIndices", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstPosition", "[", 
         RowBox[{"geneticPhenotypes", ",", "phenotype"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"phenotype", ",", 
         RowBox[{"Take", "[", 
          RowBox[{"uniquePhenotypes", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"7", ",", 
             RowBox[{"Length", "[", "uniquePhenotypes", "]"}]}], "]"}]}], 
          "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phenotypeColors", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.8", ",", "0.2", ",", "0.2"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Red", " ", "for", " ", "Compact", " ", "Dynamo"}], "*)"}], 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.2", ",", "0.4", ",", "0.8"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "Blue", " ", "for", " ", "Giant", " ", "Cluster", " ", "Core"}], 
        "*)"}], 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.1", ",", "0.7", ",", "0.1"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Green", " ", "for", " ", "Spinning", " ", "Colossus"}], 
        "*)"}], 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.9", ",", "0.5", ",", "0.1"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Orange", " ", "for", " ", "Turbulent", " ", "Giant"}], 
        "*)"}], 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.5", ",", "0.2", ",", "0.7"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Purple", " ", "for", " ", "Field", " ", "Halo"}], "*)"}], 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.6", ",", "0.4", ",", "0.2"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Brown", " ", "for", " ", "Compact", " ", "Dwarf"}], "*)"}], 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.8", ",", "0.6", ",", "0.8"}], "]"}]}], "  ", 
      RowBox[{"(*", 
       RowBox[{"Pink", " ", "for", " ", "Diffuse", " ", "Dwarf"}], "*)"}], 
      "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maturationFig", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"representativeIndices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", "t", "]"}], "/.", 
           " ", 
           RowBox[{"solution", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "representativeIndices", "]"}]}], "}"}]}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tMax"}], "}"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.004", "]"}], ",", 
            RowBox[{"phenotypeColors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Length", "[", "representativeIndices", "]"}], ",", 
              RowBox[{"Length", "[", "phenotypeColors", "]"}]}], "]"}]}], 
           "}"}]}], "]"}]}], ",", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"uniquePhenotypes", ",", 
            RowBox[{"Length", "[", "representativeIndices", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Right", ",", "Top"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"PlotLabel", "->", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Protomatter Maturation Evolution by Genetic Phenotype\>\
\"", ",", "16", ",", "Bold"}], "]"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Time since Big Bang (Gyr)\>\"", ",", "14"}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Maturation State M(t)\>\"", ",", "14"}], "]"}]}], 
         "}"}]}], ",", 
       RowBox[{"ImageSize", "->", 
        RowBox[{"{", 
         RowBox[{"600", ",", "400"}], "}"}]}], ",", 
       RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
       RowBox[{"GridLines", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "14", ",", "2"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "0.8", ",", "0.9", ",", "0.99"}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"GridLinesStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", "Dashed", ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "tMax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.05"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameStyle", "->", "Black"}], ",", 
       RowBox[{"Background", "->", "White"}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Dashed", ",", 
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"tMax", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             
             RowBox[{"\"\<Universal Satisfaction (M = 1.0)\>\"", ",", "12", ",",
               "Red"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"tMax", "*", "0.7"}], ",", "1.02"}], "}"}]}], "]"}]}], 
         "}"}]}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<maturation_evolution.jpg\>\""}], "}"}],
        "]"}], ",", "maturationFig", ",", "\"\<JPEG\>\"", ",", 
      RowBox[{"ImageResolution", "->", "300"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<\:2705 Saved Figure 1: maturation_evolution.jpg\>\"", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Figure", " ", "2"}], ":", 
     RowBox[{
     "Enhanced", " ", "Arousal", " ", "Potential", " ", "Distribution"}]}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"arousalDistFig", "=", 
     RowBox[{"Histogram", "[", 
      RowBox[{"enhancedArousalPotentials", ",", "30", ",", 
       RowBox[{"PlotLabel", "->", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Enhanced Arousal Potential Distribution\>\"", ",", "16",
           ",", "Bold"}], "]"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Enhanced Arousal Potential A_enh\>\"", ",", "14"}], 
           "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Number of Halos\>\"", ",", "14"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", 
        RowBox[{"{", 
         RowBox[{"600", ",", "400"}], "}"}]}], ",", 
       RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
       RowBox[{"ChartStyle", "->", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.7", ",", "0.3", ",", "0.9", ",", "0.8"}], "]"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameStyle", "->", "Black"}], ",", 
       RowBox[{"Background", "->", "White"}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Mark", " ", "super"}], "-", 
           RowBox[{"climax", " ", "threshold"}]}], "*)"}], 
         RowBox[{"Red", ",", "Dashed", ",", 
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"6.0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"6.0", ",", "25"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             
             RowBox[{"\"\<Super-Climax\\nThreshold\>\"", ",", "12", ",", 
              "Red"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"6.2", ",", "20"}], "}"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Mark", " ", "mean"}], "*)"}], "Blue", ",", 
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mean", "[", "enhancedArousalPotentials", "]"}], ",", 
               "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mean", "[", "enhancedArousalPotentials", "]"}], ",", 
               "25"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Mean = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"Mean", "[", "enhancedArousalPotentials", "]"}], ",",
                   "3"}], "]"}], "]"}]}], ",", "12", ",", "Blue"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Mean", "[", "enhancedArousalPotentials", "]"}], "+", 
               "0.3"}], ",", "22"}], "}"}]}], "]"}]}], "}"}]}]}], "]"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<arousal_distribution.jpg\>\""}], "}"}],
        "]"}], ",", "arousalDistFig", ",", "\"\<JPEG\>\"", ",", 
      RowBox[{"ImageResolution", "->", "300"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<\:2705 Saved Figure 2: arousal_distribution.jpg\>\"", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Figure", " ", "3"}], ":", 
     RowBox[{
     "Temporal", " ", "Evolution", " ", "of", " ", "Universal", " ", 
      "Maturation"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"temporalFig", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"totalMass", "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tMax"}], "}"}], ",", 
       RowBox[{"PlotLabel", "->", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Universal Protomatter Maturation Trajectory\>\"", ",", 
          "16", ",", "Bold"}], "]"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Time since Big Bang (Gyr)\>\"", ",", "14"}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Total Matured Mass (Normalized)\>\"", ",", "14"}], 
           "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"Thick", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.2", ",", "0.6"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "->", 
        RowBox[{"{", 
         RowBox[{"600", ",", "400"}], "}"}]}], ",", 
       RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
       RowBox[{"Filling", "->", "Axis"}], ",", 
       RowBox[{"FillingStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.2", ",", "0.6"}], "]"}], ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameStyle", "->", "Black"}], ",", 
       RowBox[{"Background", "->", "White"}], ",", 
       RowBox[{"GridLines", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "14", ",", "2"}], "]"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "300", ",", "50"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"GridLinesStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", "Dashed", ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "tMax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "320"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{"(*", 
          RowBox[{"Mark", " ", "evolutionary", " ", "phases"}], "*)"}], 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             
             RowBox[{"\"\<Tumescent\\nPhase\>\"", ",", "12", ",", "Bold", ",",
               "Blue"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "250"}], "}"}]}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             
             RowBox[{"\"\<Arousal\\nPhase\>\"", ",", "12", ",", "Bold", ",", 
              "Red"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"7", ",", "250"}], "}"}]}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             
             RowBox[{"\"\<Satisfaction\\nPhase\>\"", ",", "12", ",", "Bold", ",",
               "Purple"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"12", ",", "250"}], "}"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Phase", " ", "boundaries"}], "*)"}], "Blue", ",", 
          "Dashed", ",", 
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "300"}], "}"}]}], "}"}], "]"}], ",", "Red", ",",
           "Dashed", ",", 
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"10", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"10", ",", "300"}], "}"}]}], "}"}], "]"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDir", ",", "\"\<temporal_evolution.jpg\>\""}], "}"}], 
       "]"}], ",", "temporalFig", ",", "\"\<JPEG\>\"", ",", 
      RowBox[{"ImageResolution", "->", "300"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<\:2705 Saved Figure 3: temporal_evolution.jpg\>\"", 
     "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<\\n\|01f4ca Publication figures generated and saved to \
high-resolution JPEG format\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Ready for LaTeX paper inclusion!\\n\>\"", "]"}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Main", " ", "Dashboard"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"dashboard", "=", 
     RowBox[{"TabView", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Overview\>\"", "->", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                
                RowBox[{"\"\<Simulation Summary\>\"", ",", "Bold", ",", 
                 "16"}], "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Halos Analyzed:\>\"", ",", "numHalos"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mean Enhancement Factor:\>\"", ",", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"stats", "[", "\"\<enhancementFactor\>\"", "]"}], ",",
                    "3"}], "]"}], "]"}], "<>", "\"\<x\>\""}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Final Universe Maturation:\>\"", ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"stats", "[", "\"\<totalFinalMass\>\"", "]"}], ",", 
                 "4"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mean Final Maturation:\>\"", ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"stats", "[", "\"\<finalMean\>\"", "]"}], ",", "4"}],
                 "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Range:\>\"", ",", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"stats", "[", "\"\<finalMin\>\"", "]"}], ",", 
                   "3"}], "]"}], "]"}], "<>", "\"\< - \>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"stats", "[", "\"\<finalMax\>\"", "]"}], ",", 
                   "3"}], "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
           RowBox[{"Alignment", "->", "Left"}], ",", 
           RowBox[{"Spacings", "->", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}]}]}], "]"}]}], ",", 
        RowBox[{"\"\<Mass Evolution\>\"", "->", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"totalMass", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tMax"}], "}"}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Total Baryonic Mass Creation\>\""}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             
             RowBox[{"\"\<Time (Gyr)\>\"", 
              ",", "\"\<Total Matured Mass\>\""}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{"Thick", ",", "Red"}], "]"}]}], ",", 
           RowBox[{"Filling", "->", "Axis"}], ",", 
           RowBox[{"FillingStyle", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{"Red", ",", 
              RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
           RowBox[{"ImageSize", "->", "Large"}], ",", 
           RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ",", 
        RowBox[{"\"\<Phenotype Distribution\>\"", "->", 
         RowBox[{"BarChart", "[", 
          RowBox[{
           RowBox[{"Values", "[", "phenotypeCounts", "]"}], ",", 
           RowBox[{"ChartLabels", "->", 
            RowBox[{"Placed", "[", 
             RowBox[{
              RowBox[{"Keys", "[", "phenotypeCounts", "]"}], ",", "Below", ",", 
              RowBox[{"Rotate", "[", 
               RowBox[{"45", " ", "Degree"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Genetic Phenotype Distribution\>\""}], ",", 
           RowBox[{"ImageSize", "->", "Large"}], ",", 
           RowBox[{"ChartStyle", "->", "\"\<Rainbow\>\""}]}], "]"}]}], ",", 
        RowBox[{"\"\<Maturation Analysis\>\"", "->", 
         RowBox[{"BarChart", "[", 
          RowBox[{
           RowBox[{"phenotypeMaturation", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"ChartLabels", "->", 
            RowBox[{"Placed", "[", 
             RowBox[{
              RowBox[{"phenotypeMaturation", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "Below", ",", 
              RowBox[{"Rotate", "[", 
               RowBox[{"45", " ", "Degree"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Mean Final Maturation by Phenotype\>\""}], 
           ",", 
           RowBox[{"ImageSize", "->", "Large"}], ",", 
           RowBox[{"ChartStyle", "->", "\"\<SolarColors\>\""}]}], "]"}]}]}], 
       "}"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", "dashboard", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Individual", " ", "Halo", " ", "Explorer"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"haloExplorer", "=", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "selectedPhenotype", ",", "finalMaturation", ",", "enhancement", ",",
            "basicArousal", ",", "geneticMod"}], "}"}], ",", 
         RowBox[{
          RowBox[{"selectedPhenotype", "=", 
           RowBox[{"geneticPhenotypes", "[", 
            RowBox[{"[", "haloIndex", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"finalMaturation", "=", 
           RowBox[{"finalMaturations", "[", 
            RowBox[{"[", "haloIndex", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"basicArousal", "=", 
           RowBox[{"arousalPotentials", "[", 
            RowBox[{"[", "haloIndex", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"enhancement", "=", 
           RowBox[{
            RowBox[{"enhancedArousalPotentials", "[", 
             RowBox[{"[", "haloIndex", "]"}], "]"}], "/", "basicArousal"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"geneticMod", "=", 
           RowBox[{"haloMods", "[", 
            RowBox[{"[", "haloIndex", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"\"\<Halo \>\"", "<>", 
                RowBox[{"ToString", "[", "haloIndex", "]"}], 
                "<>", "\"\< - \>\"", "<>", 
                RowBox[{"ToString", "[", "selectedPhenotype", "]"}]}], ",", 
               "Bold", ",", "14"}], "]"}], ",", 
             RowBox[{"Grid", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<Basic Arousal Potential:\>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{"basicArousal", ",", "3"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Enhanced Arousal Potential:\>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"enhancedArousalPotentials", "[", 
                    RowBox[{"[", "haloIndex", "]"}], "]"}], ",", "3"}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Enhancement Factor:\>\"", ",", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"enhancement", ",", "3"}], "]"}], "]"}], 
                    "<>", "\"\<x\>\""}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Genetic Modifier:\>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{"geneticMod", ",", "3"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Final Maturation:\>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{"finalMaturation", ",", "4"}], "]"}]}], "}"}]}], 
                "}"}], ",", 
               RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"m", "[", "haloIndex", "]"}], "[", "t", "]"}], "/.", 
                " ", 
                RowBox[{"solution", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "tMax"}], "}"}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.05"}], "}"}]}], ",", 
               RowBox[{"PlotStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Thick", ",", "Blue"}], "]"}]}], ",", 
               RowBox[{"AxesLabel", "->", 
                RowBox[{"{", 
                 
                 RowBox[{"\"\<Time (Gyr)\>\"", 
                  ",", "\"\<Maturation State\>\""}], "}"}]}], ",", 
               RowBox[{"ImageSize", "->", "Large"}], ",", 
               RowBox[{"GridLines", "->", 
                RowBox[{"{", 
                 RowBox[{"None", ",", 
                  RowBox[{"{", 
                   RowBox[{"0.5", ",", "0.8"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"Epilog", "->", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", "Dashed", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tMax", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
                 "}"}]}]}], "]"}]}], "}"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"haloIndex", ",", "1", ",", "\"\<Select Halo\>\""}], "}"}], 
         ",", "1", ",", "numHalos", ",", "1", ",", 
         RowBox[{"Appearance", "->", "\"\<Labeled\>\""}]}], "}"}], ",", 
       RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Individual Halo Explorer:\>\"", "]"}], ";"}], "\n",
    "haloExplorer", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Phenotype", " ", "Comparison"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"phenotypeComparison", "=", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "representativeIndices", ",", "selectedPhenotypes", ",", "colors"}],
           "}"}], ",", 
         RowBox[{
          RowBox[{"selectedPhenotypes", "=", 
           RowBox[{"Take", "[", 
            RowBox[{"uniquePhenotypes", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"numPhenotypes", ",", 
               RowBox[{"Length", "[", "uniquePhenotypes", "]"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"representativeIndices", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FirstPosition", "[", 
               RowBox[{"geneticPhenotypes", ",", "phenotype"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"phenotype", ",", "selectedPhenotypes"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"colors", "=", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Red", ",", "Blue", ",", "Green", ",", "Orange", ",", "Purple", 
               ",", "Brown", ",", "Pink"}], "}"}], ",", 
             RowBox[{"Length", "[", "selectedPhenotypes", "]"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"representativeIndices", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", "t", "]"}], "/.",
                 " ", 
                RowBox[{"solution", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "representativeIndices", "]"}]}], 
                "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tMax"}], "}"}], ",", 
            RowBox[{"PlotStyle", "->", "colors"}], ",", 
            RowBox[{"PlotLegends", "->", "selectedPhenotypes"}], ",", 
            RowBox[{
            "PlotLabel", 
             "->", "\"\<Genetic Phenotype Evolution Comparison\>\""}], ",", 
            RowBox[{"AxesLabel", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<Time (Gyr)\>\"", ",", "\"\<Maturation State\>\""}],
               "}"}]}], ",", 
            RowBox[{"ImageSize", "->", "Large"}], ",", 
            RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}]}], "]"}]}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "numPhenotypes", ",", "3", ",", "\"\<Number of Phenotypes\>\""}], 
          "}"}], ",", "1", ",", 
         RowBox[{"Length", "[", "uniquePhenotypes", "]"}], ",", "1"}], "}"}], 
       ",", 
       RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Phenotype Evolution Comparison:\>\"", "]"}], 
    ";"}], "\n", "phenotypeComparison", "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<\\n\|01f389 INTERACTIVE COSMIC GENESIS COMPLETE! \
\|01f389\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<All simulation data has been saved to the \
simulation_results directory.\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Explore the universe's genetic evolution above! \:2728\
\>\"", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.961532734573824*^9, 3.961532734573824*^9}, 
   3.961533056070177*^9},ExpressionUUID->"c3adba10-a136-d548-92c4-\
859f1c5a54e7"]
},
WindowSize->{1070.25, 597.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (March 14, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"89789257-88fa-fb48-85f8-1fc362ddc3dc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 51288, 1253, 4268, "Input",ExpressionUUID->"c3adba10-a136-d548-92c4-859f1c5a54e7"]
}
]
*)

